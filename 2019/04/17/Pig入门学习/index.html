<!DOCTYPE html>
<html lang="zh-CN">










<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/favicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content>
    <meta name="author" content="Liszt_BLOG">
    <meta name="keywords" content>
    <title>pig入门学习 ~ Liszt</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.2/css/all.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/css/mdb.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_1067060_vr10bjtg3us.css">
    
        <link rel="stylesheet" href="/css/Prettify/tomorrow-night-eighties.min.css">
    
</head>

<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
<div class="container">
    <a class="navbar-brand" href="/"><strong>Liszt</strong></a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto text-center">
            
            <li class="nav-item">
                <a class="nav-link" href="/">Home</a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="/archives/">Archives</a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">About</a>
            </li>
            
        </ul>
    </div>
</div>


</nav>
    <div class="view intro-2" style='background: url("https://i.imgur.com/oADD1Ip.jpg")no-repeat center center;background-size: cover;'>
    <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
        <div class="container text-center white-text wow fadeInUp">
            <p class="h2">pig入门学习</p>
            <br>
            
            <p>Wednesday, April 17th 2019, 7:09 pm</p>
            
        </div>
        </div>
    </div>
    </div>
  </header>

  <main>
  
  <div class="container-fluid">
    <div class="row">
        <div class="col-md-8 offset-md-2 ">
            <div class="post-content py-5 z-depth-3 main">
                <h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>Apache Pig是MapReduce的一个抽象，是一个工具/平台，用于分析较大的数据集，并将它们表示为数据流。</p>
<p>可以使用Pig在Hadoop中执行所有的数据处理的操作</p>
<p>下载地址：[ <a href="http://mirrors.shu.edu.cn/apache/pig/pig-0.17.0/" target="_blank" rel="noopener">http://mirrors.shu.edu.cn/apache/pig/pig-0.17.0/</a> ]</p>
<ul>
<li>先决条件：在运行在Apache Pig之前，必须在系统上安装h好Hadooph和Java</li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><pre><code class="shell">
# 创建pig存放目录
mkdir /opt/pig

# 解压pig
tar xvf tar xvf pig-0.17.0.tar.gz
mv pig-0.17.0/*  /opt/pig

# 添加环境变量
export PIG_HOME=/opt/pig
export PIG_CLASSPATH=$PIG_HOME/conf
export PATH=$PIG_HOME/bin:$PATH

# 查看是否配置成功
pig -version
</code></pre>
<h2 id="Pig的执行模式和机制"><a href="#Pig的执行模式和机制" class="headerlink" title="Pig的执行模式和机制"></a>Pig的执行模式和机制</h2><h3 id="模式"><a href="#模式" class="headerlink" title="模式"></a>模式</h3><ul>
<li>Local模式(pig -x local)<ul>
<li>在此模式下，所有文件都从本地主机和本地文件系统加载，通常用于测试。</li>
</ul>
</li>
</ul>
<ul>
<li>MapReduce模式(pig -x mapreduce)<ul>
<li>使用Pig加载或处理Hadoop文件系统中存在的数据的地方。在这种模式下， 每当执行Pig语句来处理数据时，会在后端调用一个MapReduce作业。</li>
</ul>
</li>
</ul>
<h3 id="执行机制"><a href="#执行机制" class="headerlink" title="执行机制"></a>执行机制</h3><p><strong>通过三种方式执行，即交互模式</strong></p>
<ul>
<li><p>交互模式（Grunt shell）</p>
<ul>
<li>在此shell中，可以输入Pig Latin语句并获取输出（使用Dump运算符）</li>
</ul>
</li>
<li><p>批处理模式（脚本）</p>
<ul>
<li>可以将Pig Latin脚本写入具有.pig扩展名的单个文件中，以批处理模式运行</li>
</ul>
</li>
<li><p>嵌入式模式（UDF）</p>
<ul>
<li>Pig允许在Java等编程语言中定义自己的函数，并在脚本中运行</li>
</ul>
</li>
</ul>
<h3 id="Pig-Grunt-Shell"><a href="#Pig-Grunt-Shell" class="headerlink" title="Pig Grunt Shell"></a>Pig Grunt Shell</h3><p>示例：<code>sh ls</code><br>调用Linux shell 的ls命令</p>
<p>示例： <code>fs -ls</code><br>调用HDFS的ls命令</p>
<p>示例： <code>exec /sample_script.pig</code><br>从Grunt shell执行Pig脚本</p>
<p>示例： <code>run /sample_script.pig</code><br>从Grunt shell运行Pig脚本</p>
<p><strong>exec和run命令之间的区别是，如果使用run，则脚本中的语句在historym命令中可用</strong></p>
<h2 id="Pig-Latin"><a href="#Pig-Latin" class="headerlink" title="Pig Latin"></a>Pig Latin</h2><p>Pig Latin适用于使用Pig分析Hadoop中数据的语言</p>
<h3 id="数据模型"><a href="#数据模型" class="headerlink" title="数据模型"></a>数据模型</h3><p>Pig的数据模型是完全嵌套的。</p>
<ul>
<li>包是元组的集合</li>
<li>元组是有序的字段集</li>
<li>字段是一段数据</li>
</ul>
<h3 id="类型结构运算符"><a href="#类型结构运算符" class="headerlink" title="类型结构运算符"></a>类型结构运算符</h3><p>()    -&gt;    元组构造函数运算符，用于构建元组</p>
<p>{}    -&gt;    包构造函数运算符，用于构造包    -&gt;    示例:{（Raju,30）,（Mohammad,45）}</p>
<p>[]    -&gt;    映射构造函数运算符，用于构造一个映射    -&gt;    示例：[name＃Raja,age＃30]</p>
<h4 id="关系运算符"><a href="#关系运算符" class="headerlink" title="关系运算符"></a>关系运算符</h4><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>加载和存储</td>
</tr>
<tr>
<td>LOAD</td>
<td>将数据从文件系统(local/HDFS)加载到关系中</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>STORE</td>
<td>将数据从文件系统(local/HDFS)存储到关系中</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>过滤</td>
</tr>
<tr>
<td>FILTER</td>
<td>从关系中删除不需要的行</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>DISTINCT</td>
<td>从关系中删除重复行</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>FOREACH, GENERATE</td>
<td>基于数据列生成数据转换</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>STREAM</td>
<td>使用外部程序转换关系</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>分组和连接</td>
</tr>
<tr>
<td>JOIN</td>
<td>连接两个或多个关系</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>COGROUP</td>
<td>将数据分组为两个或多个关系</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>GROUP</td>
<td>在单个关系中对数据进行分组</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>CROSS</td>
<td>创建两个或多个关系的向量积</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>排序</td>
</tr>
<tr>
<td>ORDER</td>
<td>基于一个或多个字段（升序或降序）排列关系</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>LIMIT</td>
<td>从关系中获取有限数量的元组</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>诊断运算符</td>
</tr>
<tr>
<td>DUMP</td>
<td>在控制台打印关系的内容</td>
</tr>
</tbody>
</table>
<h3 id="LOAD-运算符"><a href="#LOAD-运算符" class="headerlink" title="LOAD 运算符"></a>LOAD 运算符</h3><p>语法： load语句由两部分组成，用“=”运算符分隔。</p>
<p>左侧是想要存储数据的关系的名称</p>
<p>右侧是需要定义如何存储数据</p>
<p><code>Relation_name = LOAD &#39;Input file path&#39; USING function as schema;</code></p>
<ul>
<li>releation_name：必须要提到要存储的关系</li>
<li>Input file path：必须提到存储文件的HDFS目录(MapReduce模式)</li>
<li>function：必须从Pig提供的一组加载函数中选择一个函数(BigStorage, JsonLoader, PigStorage, TextLoader)</li>
<li>schema：必须定义数据的模式</li>
</ul>
<p><strong>PigStorage() 函数，将数据加载并存储为结构化文本文件。它采用分隔符，使用元组的每个实体作为参数分隔。默认情况下，它以“\t”作为参数。</strong></p>
<h3 id="STORE-存储数据"><a href="#STORE-存储数据" class="headerlink" title="STORE 存储数据"></a>STORE 存储数据</h3><p>语法：<code>STORE Relation_name INTO &#39;required_directory_path&#39; [USING function];</code></p>
<h3 id="Group运算符"><a href="#Group运算符" class="headerlink" title="Group运算符"></a>Group运算符</h3><p>用于在一个或多个关系中对数据进行分组，它收集具有相同key的数据</p>
<p>语法：<code>Group_data = GROUP Relation_name BY age;</code></p>
<h3 id="Foreach运算符"><a href="#Foreach运算符" class="headerlink" title="Foreach运算符"></a>Foreach运算符</h3><p>用于基于列数据生成指定的数据转换</p>
<p>语法：<code>Relation_name2 = FOREACH Relation_name1 GENRATE (required data);</code></p>

                <hr>
                <div>
                    <p>
                        
                    </p>
                </div>
                <br>
                
                    <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
                
            </div>
        </div>
        <div class="d-none d-md-block col-md-2">
            
  <div id="toc" class="py-5">
    <p class="h6"><i class="iconfont icon-toc" style="vertical-align:middle"></i> Toc:</p> 
    <div id="tocbot"></div>
  </div>

        </div>
    </div>        
</div>

<br><br><br>

<!-- Comments -->
<div class="comments" id="comments">
 
</div>
  
  </main>

<footer class="mt-5">
  <div class="text-center py-3">
    <a href="https://hexo.io" target="_blank"><b>HEXO</b></a>
    <i class="iconfont icon-love"></i>
    <a href="https://github.com/0x2e/Material-T" target="_blank"> <b>Material-T</b></a>
  </div>
</footer>

  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/jquery-3.3.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/mdb.min.js"></script>
  <script src="/js/main.js"></script>
  
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    
    <script src="/js/post.js"></script>
    
      <script src="/js/plugins/prettify.js"></script>
      <script>
          $(document).ready(function(){
              $('pre').addClass('prettyprint linenums');
              prettyPrint();
          })
      </script>
    
  
</body>
</html>